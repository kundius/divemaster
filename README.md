# Divemaster

based on top of [Nestjs], [Nextjs].

# TODO

Тегом HIERARCHY_DEPTH_LIMIT помечены места, относящиеся к ограничению вложенности категорий.

В отличии от фильтров, поля сортировки передаются напрямую в запрос. Если указать несуществующее поле будет ошибка. Подумать, стоит ли предустановить список полей для сортировки.

# Товарные предложения

Стоимость товаров зависит от товарных предложений.

Товарные предложения могут быть связаны с уникальным набором опций, тогда они считаются дополнительными.

Товарное предложение может не быть связано с какой либо из опций, тогда оно считается базовым.

В зависимости от набора товарных предложений может меняться поведение:

- Нет товарных предложений - по умолчанию цена "по запросу". При выборе опций цена не меняется. Вместо добавить в корзину кнопка запроса цены.
- Только базовое товарное предложение - по умолчанию цена базового. При выборе опций цена не меняется.
- Только дополнительные товарные предложения - по умолчанию цена "от (минимальная)". При выборе опций выводится цена соответствующего товарного предложения. Если соответствующее опциям товарное предложение не найдено выводится цена "по запросу".
- Базовое и дополнительные товарные предложения - по умолчанию цена "от (минимальная)". При выборе опций выводится цена соответствующего товарного предложения. Если соответствующее опциям товарное предложение не найдено выводится цена "по запросу". Базовое в таком случае не используется вовсе.

Из разговора с заказчиком:
Есть товары только в одной комплектации, без параметров, там и цена одна.
Поэтому если есть только базовый оффер, используем только его.
Если у товара есть и базовый оффер и дополнительные, то базовый игнорируем.

# DB
npx typeorm-ts-node-commonjs migration:generate -d db/ormconfig.ts db/migrations/name
